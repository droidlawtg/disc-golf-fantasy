<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rick is #1 Fantasy League</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Exo+2:wght@400;600;700;900&display=swap" rel="stylesheet">
<style>
/* ============================================================
   RICK IS #1 FANTASY LEAGUE ‚Äî 80s ARCADE EDITION
   ============================================================ */

:root {
  --bg:       #060410;
  --bg2:      #0c0820;
  --panel:    #100d24;
  --panel2:   #16122e;
  --border:   #ffffff0a;
  --border2:  #ffffff18;

  /* 80s neon palette */
  --neon-pink:   #ff2d78;
  --neon-cyan:   #00f5ff;
  --neon-yellow: #ffe600;
  --neon-orange: #ff6b00;
  --neon-green:  #39ff14;
  --neon-purple: #bf00ff;

  /* Team colors */
  --rick:  #00f5ff;
  --joe:   #ff2d78;
  --rory:  #39ff14;

  --text:  #f0eeff;
  --muted: #5a5480;
  --gold:  #ffe600;

  --scanline: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(0,0,0,0.15) 2px,
    rgba(0,0,0,0.15) 4px
  );
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Exo 2', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  cursor: default;
}

/* ---- GRID FLOOR BACKGROUND ---- */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    linear-gradient(to bottom, transparent 60%, var(--bg) 100%),
    repeating-linear-gradient(90deg, #ffffff06 0px, #ffffff06 1px, transparent 1px, transparent 60px),
    repeating-linear-gradient(0deg,  #ffffff06 0px, #ffffff06 1px, transparent 1px, transparent 60px);
  background-size: 100% 100%, 60px 60px, 60px 60px;
  perspective: 300px;
  pointer-events: none;
  z-index: 0;
}

/* ---- GLOW ORBS ---- */
body::after {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 40% at 20% 10%, #ff2d7818 0%, transparent 60%),
    radial-gradient(ellipse 60% 40% at 80% 90%, #00f5ff12 0%, transparent 60%),
    radial-gradient(ellipse 40% 30% at 50% 50%, #bf00ff08 0%, transparent 60%);
  pointer-events: none;
  z-index: 0;
}

/* ---- SCANLINE OVERLAY ---- */
.scanlines {
  position: fixed;
  inset: 0;
  background: var(--scanline);
  pointer-events: none;
  z-index: 999;
  opacity: 0.4;
}

/* ============================================================
   HEADER
   ============================================================ */

header {
  position: sticky;
  top: 0;
  z-index: 100;
  background: #060410ee;
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--neon-pink)40;
  box-shadow: 0 0 30px var(--neon-pink)15, 0 2px 0 var(--neon-pink)30;
  padding: 0 2rem;
  height: 72px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 1rem;
}

.logo {
  display: flex;
  align-items: center;
  gap: 14px;
  flex-shrink: 0;
}

/* Disc logo ‚Äî animated neon disc */
.disc-wrap {
  position: relative;
  width: 42px;
  height: 42px;
  flex-shrink: 0;
}

.disc-ring {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 3px solid transparent;
  animation: disc-spin 4s linear infinite;
}

.disc-ring.r1 {
  border-top-color: var(--neon-pink);
  border-right-color: var(--neon-pink)60;
  filter: drop-shadow(0 0 6px var(--neon-pink));
}

.disc-ring.r2 {
  inset: 7px;
  border-bottom-color: var(--neon-cyan);
  border-left-color: var(--neon-cyan)60;
  filter: drop-shadow(0 0 4px var(--neon-cyan));
  animation-direction: reverse;
  animation-duration: 2.5s;
}

.disc-center {
  position: absolute;
  inset: 16px;
  border-radius: 50%;
  background: radial-gradient(circle, var(--neon-yellow)80, var(--neon-orange));
  box-shadow: 0 0 10px var(--neon-yellow);
}

@keyframes disc-spin { to { transform: rotate(360deg); } }

.logo-text {
  line-height: 1.1;
}

.logo-title {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.75rem;
  letter-spacing: 0.05em;
  text-shadow: 0 0 10px var(--neon-pink), 0 0 20px var(--neon-pink)60;
  color: var(--neon-pink);
}

.logo-title span { color: var(--neon-yellow); text-shadow: 0 0 10px var(--neon-yellow); }

.logo-sub {
  font-size: 0.6rem;
  color: var(--muted);
  letter-spacing: 0.15em;
  text-transform: uppercase;
  display: block;
  margin-top: 4px;
}

/* ---- NAV ---- */
nav {
  display: flex;
  gap: 3px;
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 8px;
  padding: 4px;
}

nav button {
  background: transparent;
  border: none;
  color: var(--muted);
  font-family: 'Exo 2', sans-serif;
  font-weight: 700;
  font-size: 0.78rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  padding: 0.45rem 1rem;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.15s;
  white-space: nowrap;
}

nav button:hover {
  color: var(--neon-cyan);
  background: var(--panel2);
  text-shadow: 0 0 8px var(--neon-cyan)80;
}

nav button.active {
  background: linear-gradient(135deg, var(--neon-pink)20, var(--neon-purple)20);
  color: var(--neon-pink);
  border: 1px solid var(--neon-pink)50;
  text-shadow: 0 0 8px var(--neon-pink);
  box-shadow: 0 0 12px var(--neon-pink)20;
}

/* ============================================================
   MAIN
   ============================================================ */

main {
  position: relative;
  z-index: 1;
  max-width: 1160px;
  margin: 0 auto;
  padding: 2.5rem 2rem;
}

.page { display: none; }
.page.active {
  display: block;
  animation: pageIn 0.3s ease;
}

@keyframes pageIn {
  from { opacity:0; transform:translateY(10px); }
  to   { opacity:1; transform:translateY(0); }
}

/* ---- SECTION TITLE ---- */
.section-title {
  font-family: 'Press Start 2P', monospace;
  font-size: 1.3rem;
  line-height: 1.5;
  margin-bottom: 2rem;
  letter-spacing: 0.04em;
}

.section-title .hl-pink   { color: var(--neon-pink);   text-shadow: 0 0 15px var(--neon-pink); }
.section-title .hl-cyan   { color: var(--neon-cyan);   text-shadow: 0 0 15px var(--neon-cyan); }
.section-title .hl-yellow { color: var(--neon-yellow); text-shadow: 0 0 15px var(--neon-yellow); }
.section-title .hl-green  { color: var(--neon-green);  text-shadow: 0 0 15px var(--neon-green); }

/* ---- NEON PANEL ---- */
.neon-panel {
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 12px;
  overflow: hidden;
  position: relative;
}

.neon-panel::before {
  content: '';
  position: absolute;
  inset: 0;
  background: var(--scanline);
  pointer-events: none;
  opacity: 0.3;
  z-index: 1;
}

/* ============================================================
   STANDINGS
   ============================================================ */

.standings-grid { display: grid; gap: 1.1rem; }

.team-card {
  background: var(--panel);
  border-radius: 12px;
  padding: 1.75rem 2rem;
  display: flex;
  align-items: center;
  gap: 2rem;
  position: relative;
  overflow: hidden;
  cursor: default;
  transition: transform 0.2s;
  animation: cardIn 0.5s ease both;
}

.team-card:nth-child(1) { animation-delay:0.05s; }
.team-card:nth-child(2) { animation-delay:0.1s; }
.team-card:nth-child(3) { animation-delay:0.15s; }

@keyframes cardIn {
  from { opacity:0; transform:translateX(-20px); }
  to   { opacity:1; transform:translateX(0); }
}

.team-card:hover { transform: translateY(-2px); }

/* Team color borders and glows */
.team-card.rick {
  border: 1px solid var(--rick)50;
  box-shadow: 0 0 20px var(--rick)10, inset 0 0 30px var(--rick)05;
}
.team-card.joe {
  border: 1px solid var(--joe)50;
  box-shadow: 0 0 20px var(--joe)10, inset 0 0 30px var(--joe)05;
}
.team-card.rory {
  border: 1px solid var(--rory)50;
  box-shadow: 0 0 20px var(--rory)10, inset 0 0 30px var(--rory)05;
}

.team-card::before {
  content: '';
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 5px;
  border-radius: 5px 0 0 5px;
}

.team-card.rick::before { background: var(--rick); box-shadow: 0 0 10px var(--rick); }
.team-card.joe::before  { background: var(--joe);  box-shadow: 0 0 10px var(--joe); }
.team-card.rory::before { background: var(--rory); box-shadow: 0 0 10px var(--rory); }

.team-card.first {
  border-color: var(--gold)60;
  box-shadow: 0 0 30px var(--gold)15, inset 0 0 40px var(--gold)05;
}

.team-card.first::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, var(--gold)08 0%, transparent 50%);
  pointer-events: none;
}

/* Scanlines on cards */
.team-card .scan {
  position: absolute;
  inset: 0;
  background: var(--scanline);
  opacity: 0.2;
  pointer-events: none;
}

.team-rank {
  font-family: 'Press Start 2P', monospace;
  font-size: 2rem;
  min-width: 64px;
  text-align: center;
  line-height: 1;
  color: var(--muted);
}

.team-card.first .team-rank {
  color: var(--gold);
  text-shadow: 0 0 20px var(--gold), 0 0 40px var(--gold)60;
}

.team-info { flex: 1; }

.team-name {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.85rem;
  letter-spacing: 0.06em;
  margin-bottom: 0.5rem;
  line-height: 1.4;
}

.team-card.rick .team-name { color: var(--rick); text-shadow: 0 0 12px var(--rick); }
.team-card.joe  .team-name { color: var(--joe);  text-shadow: 0 0 12px var(--joe); }
.team-card.rory .team-name { color: var(--rory); text-shadow: 0 0 12px var(--rory); }

.team-meta { font-size: 0.7rem; color: var(--muted); letter-spacing: 0.1em; text-transform: uppercase; }

.team-pts-wrap { text-align: right; }

.team-points {
  font-family: 'Press Start 2P', monospace;
  font-size: 2.2rem;
  line-height: 1;
  color: var(--neon-yellow);
  text-shadow: 0 0 15px var(--neon-yellow), 0 0 30px var(--neon-yellow)60;
}

.team-pts-label {
  font-size: 0.6rem;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.15em;
  margin-top: 6px;
}

/* ============================================================
   TABLES
   ============================================================ */

.retro-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--panel);
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid var(--border2);
  position: relative;
}

.retro-table thead tr {
  background: linear-gradient(135deg, var(--neon-pink)15, var(--neon-purple)15);
  border-bottom: 1px solid var(--neon-pink)40;
}

.retro-table th {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--neon-pink);
  text-shadow: 0 0 8px var(--neon-pink)80;
  padding: 1rem 1.1rem;
  text-align: left;
}

.retro-table th.center, .retro-table td.center { text-align: center; }

.retro-table td {
  padding: 0.8rem 1.1rem;
  border-top: 1px solid var(--border);
  font-size: 0.88rem;
}

.retro-table tbody tr { transition: background 0.15s; }

.retro-table tbody tr:hover {
  background: linear-gradient(135deg, var(--neon-cyan)05, var(--neon-purple)05);
}

.rank-pill {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--panel2);
  border: 1px solid var(--border2);
  color: var(--muted);
}

.rank-pill.r1 { background: var(--gold); color: #000; border-color: var(--gold); box-shadow: 0 0 12px var(--gold); }
.rank-pill.r2 { background: #9ca3af; color: #000; border-color: #9ca3af; }
.rank-pill.r3 { background: #b45309; color: #fff; border-color: #b45309; }

.team-dot {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 8px;
  flex-shrink: 0;
  vertical-align: middle;
}

.dot-rick { background: var(--rick); box-shadow: 0 0 6px var(--rick); }
.dot-joe  { background: var(--joe);  box-shadow: 0 0 6px var(--joe); }
.dot-rory { background: var(--rory); box-shadow: 0 0 6px var(--rory); }

.div-pill {
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  padding: 2px 8px;
  border-radius: 4px;
  text-transform: uppercase;
  font-family: 'Press Start 2P', monospace;
}

.div-mpo { background: var(--rick)18; color: var(--rick); border: 1px solid var(--rick)30; }
.div-fpo { background: var(--joe)18;  color: var(--joe);  border: 1px solid var(--joe)30; }

/* ============================================================
   RESULTS
   ============================================================ */

.results-grid { display: grid; gap: 1.25rem; }

.result-card {
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 12px;
  overflow: hidden;
}

.result-header {
  padding: 1rem 1.5rem;
  background: linear-gradient(135deg, var(--panel2), var(--panel));
  border-bottom: 1px solid var(--border2);
  display: flex;
  align-items: center;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.result-name {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.6rem;
  letter-spacing: 0.06em;
  color: var(--neon-cyan);
  text-shadow: 0 0 8px var(--neon-cyan)80;
  line-height: 1.6;
}

.result-meta { display: flex; align-items: center; gap: 0.6rem; }

.type-badge {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  letter-spacing: 0.08em;
  padding: 4px 10px;
  border-radius: 4px;
  text-transform: uppercase;
}

.type-major     { background: var(--gold)20;        color: var(--gold);       border: 1px solid var(--gold)40;       box-shadow: 0 0 8px var(--gold)20; }
.type-eliteplus { background: var(--neon-purple)20;  color: var(--neon-purple); border: 1px solid var(--neon-purple)40; }
.type-regular   { background: var(--panel2);         color: var(--muted);      border: 1px solid var(--border2); }

.mult-tag {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  color: var(--muted);
}

.result-body { display: grid; grid-template-columns: 1fr 1fr; }

.div-col { padding: 1rem 1.5rem; }
.div-col:first-child { border-right: 1px solid var(--border); }

.div-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.5rem;
  letter-spacing: 0.2em;
  color: var(--muted);
  margin-bottom: 0.75rem;
}

.result-row {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  padding: 0.3rem 0;
  font-size: 0.85rem;
}

.result-place {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  min-width: 24px;
  color: var(--muted);
}

.result-place.p1 { color: var(--gold); text-shadow: 0 0 8px var(--gold); }
.result-place.p2 { color: #9ca3af; }
.result-place.p3 { color: #cd7c2a; }

.result-player.drafted { font-weight: 700; }
.result-pts {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  color: var(--neon-green);
  text-shadow: 0 0 8px var(--neon-green)80;
  margin-left: auto;
}

/* ============================================================
   ROSTER
   ============================================================ */

.roster-grid { display: grid; grid-template-columns: repeat(3,1fr); gap: 1.5rem; }

.roster-card {
  background: var(--panel);
  border-radius: 12px;
  overflow: hidden;
  animation: cardIn 0.5s ease both;
}

.roster-card:nth-child(1) { animation-delay:0.05s; border:1px solid var(--rick)40; box-shadow:0 0 20px var(--rick)08; }
.roster-card:nth-child(2) { animation-delay:0.1s;  border:1px solid var(--joe)40;  box-shadow:0 0 20px var(--joe)08; }
.roster-card:nth-child(3) { animation-delay:0.15s; border:1px solid var(--rory)40; box-shadow:0 0 20px var(--rory)08; }

.roster-head {
  padding: 1.1rem 1.5rem;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.65rem;
  letter-spacing: 0.08em;
  border-bottom: 1px solid var(--border2);
  line-height: 1.5;
}

.roster-head.rick { background: linear-gradient(135deg, #001a2e, var(--panel2)); color: var(--rick); text-shadow: 0 0 10px var(--rick); border-bottom-color: var(--rick)30; }
.roster-head.joe  { background: linear-gradient(135deg, #2e0010, var(--panel2)); color: var(--joe);  text-shadow: 0 0 10px var(--joe);  border-bottom-color: var(--joe)30; }
.roster-head.rory { background: linear-gradient(135deg, #002e10, var(--panel2)); color: var(--rory); text-shadow: 0 0 10px var(--rory); border-bottom-color: var(--rory)30; }

.div-section-label {
  padding: 0.45rem 1.5rem 0.3rem;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  letter-spacing: 0.2em;
  color: var(--muted);
  background: var(--panel2);
  border-top: 1px solid var(--border);
}

.roster-player {
  padding: 0.65rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-top: 1px solid var(--border);
  font-size: 0.85rem;
  transition: background 0.15s;
}

.roster-player:hover { background: var(--panel2); }

/* ============================================================
   WAIVER WIRE
   ============================================================ */

.waiver-layout { display: grid; grid-template-columns: 1fr 320px; gap: 1.5rem; align-items: start; }

.waiver-div-tabs {
  display: flex;
  gap: 4px;
  margin-bottom: 1.1rem;
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 8px;
  padding: 4px;
  width: fit-content;
}

.waiver-tab {
  background: transparent;
  border: none;
  color: var(--muted);
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  letter-spacing: 0.08em;
  padding: 0.5rem 1.2rem;
  border-radius: 5px;
  cursor: pointer;
  transition: all 0.15s;
  text-transform: uppercase;
}

.waiver-tab:hover { color: var(--neon-cyan); }
.waiver-tab.active { background: var(--neon-pink)20; color: var(--neon-pink); border: 1px solid var(--neon-pink)50; text-shadow: 0 0 8px var(--neon-pink); }

.add-btn {
  background: linear-gradient(135deg, var(--neon-green)20, var(--neon-cyan)20);
  border: 1px solid var(--neon-green)50;
  color: var(--neon-green);
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  letter-spacing: 0.06em;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s;
  text-shadow: 0 0 6px var(--neon-green)80;
}

.add-btn:hover {
  background: var(--neon-green)30;
  box-shadow: 0 0 12px var(--neon-green)40;
}

/* ---- TRANSACTION PANEL ---- */
.txn-panel {
  background: var(--panel);
  border: 1px solid var(--neon-pink)30;
  border-radius: 12px;
  overflow: hidden;
  position: sticky;
  top: 88px;
  box-shadow: 0 0 25px var(--neon-pink)10;
}

.txn-header {
  padding: 1rem 1.5rem;
  background: linear-gradient(135deg, var(--neon-pink)15, var(--neon-purple)15);
  border-bottom: 1px solid var(--neon-pink)30;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.6rem;
  color: var(--neon-pink);
  text-shadow: 0 0 8px var(--neon-pink);
  letter-spacing: 0.08em;
}

.txn-body { padding: 1.25rem; }

.txn-step { margin-bottom: 1.1rem; }

.txn-label {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  letter-spacing: 0.15em;
  color: var(--muted);
  margin-bottom: 0.5rem;
  text-transform: uppercase;
}

.txn-select {
  width: 100%;
  background: var(--panel2);
  border: 1px solid var(--border2);
  border-radius: 6px;
  color: var(--text);
  font-family: 'Exo 2', sans-serif;
  font-size: 0.85rem;
  padding: 0.6rem 0.85rem;
  outline: none;
  cursor: pointer;
  transition: border-color 0.2s;
  appearance: none;
}

.txn-select:focus { border-color: var(--neon-pink)60; box-shadow: 0 0 8px var(--neon-pink)20; }

.selected-add {
  background: var(--neon-green)10;
  border: 1px solid var(--neon-green)30;
  border-radius: 6px;
  padding: 0.6rem 0.85rem;
  font-size: 0.85rem;
  color: var(--muted);
  min-height: 38px;
}

.selected-add.filled { color: var(--neon-green); text-shadow: 0 0 6px var(--neon-green)60; }

.cost-badge {
  background: var(--panel2);
  border: 1px solid var(--border2);
  border-radius: 6px;
  padding: 0.6rem 0.85rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 0.8rem;
}

.cost-number {
  font-family: 'Press Start 2P', monospace;
  font-size: 1rem;
  color: var(--neon-pink);
  text-shadow: 0 0 10px var(--neon-pink);
}

.confirm-btn {
  width: 100%;
  background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
  color: #fff;
  border: none;
  border-radius: 8px;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  letter-spacing: 0.1em;
  padding: 0.85rem;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 1rem;
  text-transform: uppercase;
  box-shadow: 0 0 20px var(--neon-pink)30;
}

.confirm-btn:hover { box-shadow: 0 0 30px var(--neon-pink)50; transform: translateY(-1px); }
.confirm-btn:active { transform: translateY(0); }
.confirm-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; box-shadow: none; }

/* Transaction log */
.txn-log {
  border-top: 1px solid var(--border2);
  padding: 1rem 1.25rem;
  max-height: 220px;
  overflow-y: auto;
}

.txn-log::-webkit-scrollbar { width: 4px; }
.txn-log::-webkit-scrollbar-track { background: var(--panel); }
.txn-log::-webkit-scrollbar-thumb { background: var(--neon-pink)40; border-radius: 2px; }

.txn-log-title {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  letter-spacing: 0.2em;
  color: var(--muted);
  margin-bottom: 0.75rem;
}

.txn-entry {
  font-size: 0.78rem;
  color: var(--muted);
  padding: 0.4rem 0;
  border-bottom: 1px solid var(--border);
  line-height: 1.6;
}

.txn-entry:last-child { border-bottom: none; }
.txn-entry .in   { color: var(--neon-green);  font-weight: 700; }
.txn-entry .out  { color: var(--neon-pink);   font-weight: 700; }
.txn-entry .cost-tag { color: var(--gold); font-family:'Press Start 2P',monospace; font-size:0.5rem; }

/* Sync status */
.sync-status {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.45rem;
  padding: 0.4rem 0.75rem;
  border-radius: 4px;
  letter-spacing: 0.08em;
  display: inline-block;
  margin-top: 0.5rem;
}

.sync-ok      { background: var(--neon-green)15; color: var(--neon-green); border: 1px solid var(--neon-green)30; }
.sync-pending { background: var(--gold)15;       color: var(--gold);       border: 1px solid var(--gold)30; }
.sync-error   { background: var(--neon-pink)15;  color: var(--neon-pink);  border: 1px solid var(--neon-pink)30; }

/* ============================================================
   SETUP
   ============================================================ */

.setup-card {
  background: var(--panel);
  border: 1px solid var(--neon-cyan)30;
  border-radius: 12px;
  padding: 2rem;
  max-width: 620px;
  box-shadow: 0 0 30px var(--neon-cyan)08;
}

.setup-card h3 {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.7rem;
  color: var(--neon-cyan);
  text-shadow: 0 0 10px var(--neon-cyan);
  letter-spacing: 0.08em;
  margin-bottom: 1.25rem;
  line-height: 1.6;
}

.setup-card p { font-size: 0.85rem; color: var(--muted); margin-bottom: 0.75rem; line-height: 1.7; }
.setup-card code { background: var(--panel2); border:1px solid var(--border2); border-radius:4px; padding:0.1em 0.4em; font-size:0.82rem; color:var(--neon-yellow); }

.setup-input {
  width: 100%;
  background: var(--panel2);
  border: 1px solid var(--border2);
  border-radius: 7px;
  color: var(--text);
  font-family: 'Exo 2', sans-serif;
  font-size: 0.9rem;
  padding: 0.75rem 1rem;
  margin-bottom: 0.75rem;
  outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.setup-input:focus {
  border-color: var(--neon-cyan)60;
  box-shadow: 0 0 10px var(--neon-cyan)15;
}

.setup-btn {
  background: linear-gradient(135deg, var(--neon-cyan)80, var(--neon-purple)80);
  color: #000;
  border: none;
  border-radius: 7px;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.55rem;
  letter-spacing: 0.1em;
  padding: 0.8rem 2rem;
  cursor: pointer;
  transition: all 0.2s;
  box-shadow: 0 0 15px var(--neon-cyan)30;
}

.setup-btn:hover { box-shadow: 0 0 25px var(--neon-cyan)50; transform: translateY(-1px); }

/* ============================================================
   MODAL
   ============================================================ */

.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  background: #00000095;
  backdrop-filter: blur(10px);
  z-index: 1000;
  align-items: center;
  justify-content: center;
}

.modal-overlay.open { display: flex; }

.modal {
  background: var(--panel);
  border: 1px solid var(--neon-pink)50;
  border-radius: 16px;
  padding: 2rem;
  max-width: 440px;
  width: 90%;
  box-shadow: 0 0 50px var(--neon-pink)20;
  animation: modalIn 0.25s ease;
}

@keyframes modalIn {
  from { opacity:0; transform:scale(0.9) translateY(20px); }
  to   { opacity:1; transform:scale(1) translateY(0); }
}

.modal h3 {
  font-family: 'Press Start 2P', monospace;
  font-size: 0.7rem;
  color: var(--neon-yellow);
  text-shadow: 0 0 10px var(--neon-yellow);
  margin-bottom: 1.25rem;
  line-height: 1.6;
  letter-spacing: 0.06em;
}

.modal-detail {
  background: var(--panel2);
  border: 1px solid var(--border2);
  border-radius: 8px;
  padding: 1.1rem;
  margin-bottom: 1.25rem;
  font-size: 0.85rem;
  line-height: 1.8;
}

.modal-detail strong { color: var(--neon-cyan); }
.modal-detail .warn  { color: var(--neon-yellow); font-weight: 700; }

.modal-actions { display: flex; gap: 0.75rem; }

.modal-cancel {
  flex: 1;
  background: var(--panel2);
  border: 1px solid var(--border2);
  color: var(--text);
  border-radius: 8px;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.5rem;
  letter-spacing: 0.08em;
  padding: 0.75rem;
  cursor: pointer;
  transition: background 0.15s;
}

.modal-cancel:hover { background: var(--panel); }

.modal-confirm {
  flex: 2;
  background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
  color: #fff;
  border: none;
  border-radius: 8px;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.5rem;
  letter-spacing: 0.08em;
  padding: 0.75rem;
  cursor: pointer;
  transition: opacity 0.2s;
  box-shadow: 0 0 15px var(--neon-pink)40;
}

.modal-confirm:hover { opacity: 0.85; }

/* ============================================================
   LOADING / EMPTY
   ============================================================ */

.loading {
  text-align: center;
  padding: 4rem 2rem;
  color: var(--muted);
}

.spin-disc {
  width: 48px;
  height: 48px;
  border-radius: 50%;
  border: 3px solid var(--border2);
  border-top-color: var(--neon-pink);
  border-right-color: var(--neon-cyan);
  animation: spin 0.7s linear infinite;
  margin: 0 auto 1rem;
  box-shadow: 0 0 15px var(--neon-pink)30;
}

@keyframes spin { to { transform: rotate(360deg); } }

.empty-msg {
  background: var(--panel);
  border: 1px solid var(--border2);
  border-radius: 12px;
  padding: 2rem;
  text-align: center;
  color: var(--muted);
  font-size: 0.85rem;
  line-height: 1.7;
}

/* ============================================================
   TICKER (scrolling announcement)
   ============================================================ */

.ticker-wrap {
  background: var(--neon-pink)10;
  border-top: 1px solid var(--neon-pink)30;
  border-bottom: 1px solid var(--neon-pink)30;
  overflow: hidden;
  white-space: nowrap;
  padding: 0.4rem 0;
  margin-bottom: 2rem;
}

.ticker-content {
  display: inline-block;
  animation: ticker 30s linear infinite;
  font-family: 'Press Start 2P', monospace;
  font-size: 0.5rem;
  color: var(--neon-pink);
  text-shadow: 0 0 6px var(--neon-pink)80;
  letter-spacing: 0.1em;
}

@keyframes ticker { from { transform: translateX(100vw); } to { transform: translateX(-100%); } }

/* ============================================================
   RESPONSIVE
   ============================================================ */

@media (max-width: 900px) {
  .waiver-layout  { grid-template-columns: 1fr; }
  .roster-grid    { grid-template-columns: 1fr; }
  .result-body    { grid-template-columns: 1fr; }
  .div-col:first-child { border-right: none; border-bottom: 1px solid var(--border); }
  .section-title  { font-size: 0.9rem; }
  .team-points    { font-size: 1.5rem; }
  nav button      { font-size: 0.65rem; padding: 0.35rem 0.6rem; }
  .logo-title     { font-size: 0.6rem; }
}
</style>
</head>
<body>

<div class="scanlines"></div>

<header>
  <div class="logo">
    <div class="disc-wrap">
      <div class="disc-ring r1"></div>
      <div class="disc-ring r2"></div>
      <div class="disc-center"></div>
    </div>
    <div class="logo-text">
      <div class="logo-title">RICK IS <span>#1</span> FANTASY</div>
      <span class="logo-sub">2026 PDGA Elite Series ¬∑ 3 Teams ¬∑ 22 Events</span>
    </div>
  </div>
  <nav>
    <button class="active" onclick="showPage('standings',this)">Standings</button>
    <button onclick="showPage('players',this)">Players</button>
    <button onclick="showPage('results',this)">Results</button>
    <button onclick="showPage('roster',this)">Roster</button>
    <button onclick="showPage('waiver',this)">Waiver Wire</button>
    <button onclick="showPage('setup',this)">Setup</button>
  </nav>
</header>

<main>

  <!-- ======== STANDINGS ======== -->
  <div id="page-standings" class="page active">
    <div class="section-title"><span class="hl-pink">LEAGUE</span> <span class="hl-yellow">STANDINGS</span></div>
    <div class="ticker-wrap">
      <span class="ticker-content">‚òÖ RICK IS #1 FANTASY LEAGUE 2026 ‚òÖ PDGA ELITE SERIES ‚òÖ 22 TOURNAMENTS ‚òÖ 3 TEAMS ‚òÖ F1-STYLE SCORING ‚òÖ MAJORS 1.5X ¬∑ ELITE PLUS 1.25X ‚òÖ MAY THE BEST TEAM WIN ‚òÖ</span>
    </div>
    <div id="standings-content" class="standings-grid">
      <div class="loading"><div class="spin-disc"></div>Loading standings...</div>
    </div>
  </div>

  <!-- ======== PLAYERS ======== -->
  <div id="page-players" class="page">
    <div class="section-title"><span class="hl-cyan">PLAYER</span> <span class="hl-yellow">STATS</span></div>
    <div id="players-content">
      <div class="loading"><div class="spin-disc"></div>Loading player stats...</div>
    </div>
  </div>

  <!-- ======== RESULTS ======== -->
  <div id="page-results" class="page">
    <div class="section-title"><span class="hl-pink">TOURNAMENT</span> <span class="hl-cyan">RESULTS</span></div>
    <div id="results-content" class="results-grid">
      <div class="loading"><div class="spin-disc"></div>Loading results...</div>
    </div>
  </div>

  <!-- ======== ROSTER ======== -->
  <div id="page-roster" class="page">
    <div class="section-title"><span class="hl-green">TEAM</span> <span class="hl-yellow">ROSTERS</span></div>
    <div id="roster-content" class="roster-grid"></div>
  </div>

  <!-- ======== WAIVER WIRE ======== -->
  <div id="page-waiver" class="page">
    <div class="section-title"><span class="hl-pink">WAIVER</span> <span class="hl-cyan">WIRE</span></div>
    <div class="waiver-layout">

      <div>
        <div class="waiver-div-tabs">
          <button class="waiver-tab active" onclick="showWaiverDiv('MPO',this)">MPO TOP 50</button>
          <button class="waiver-tab" onclick="showWaiverDiv('FPO',this)">FPO TOP 30</button>
        </div>
        <div class="neon-panel">
          <table class="retro-table" id="waiver-table">
            <thead>
              <tr>
                <th class="center">Rank</th>
                <th>Player</th>
                <th class="center">Status</th>
                <th class="center">Action</th>
              </tr>
            </thead>
            <tbody id="waiver-tbody"></tbody>
          </table>
        </div>
      </div>

      <!-- Transaction Panel -->
      <div class="txn-panel">
        <div class="txn-header">// MAKE A MOVE</div>
        <div class="txn-body">

          <div class="txn-step">
            <div class="txn-label">01 / Select Your Team</div>
            <select class="txn-select" id="txn-team" onchange="updateTxnPanel()">
              <option value="">‚Äî Choose team ‚Äî</option>
              <option value="Team Rick">Team Rick</option>
              <option value="Team Joe">Team Joe</option>
              <option value="Team Rory">Team Rory</option>
            </select>
          </div>

          <div class="txn-step">
            <div class="txn-label">02 / Player to Add</div>
            <div class="selected-add" id="txn-add-display">Click ADD next to a player</div>
          </div>

          <div class="txn-step">
            <div class="txn-label">03 / Player to Drop</div>
            <select class="txn-select" id="txn-drop" onchange="updateTxnPanel()">
              <option value="">‚Äî Select player to drop ‚Äî</option>
            </select>
          </div>

          <div class="txn-step">
            <div class="txn-label">Transaction Cost</div>
            <div class="cost-badge">
              <span id="txn-cost-label" style="font-size:0.78rem">Select team first</span>
              <span class="cost-number" id="txn-cost-pts">‚Äî</span>
            </div>
          </div>

          <button class="confirm-btn" id="txn-confirm-btn" onclick="openConfirmModal()" disabled>
            CONFIRM TRADE
          </button>

          <div id="sync-status-msg"></div>
        </div>

        <div class="txn-log">
          <div class="txn-log-title">// TRANSACTION LOG</div>
          <div id="txn-log-list"></div>
        </div>
      </div>

    </div>
  </div>

  <!-- ======== SETUP ======== -->
  <div id="page-setup" class="page">
    <div class="section-title"><span class="hl-cyan">SETUP</span></div>
    <div class="setup-card">
      <h3>CONNECT GOOGLE SHEET</h3>
      <p>This site reads live data from your Google Sheet and also writes roster changes back to it.</p>
      <p><strong>Step 1:</strong> Publish your sheet publicly: <code>File ‚Üí Share ‚Üí Publish to web ‚Üí Publish</code></p>
      <p><strong>Step 2:</strong> Find your Sheet ID in the URL between <code>/d/</code> and <code>/edit</code></p>
      <p><strong>Step 3:</strong> Paste it below and hit Save.</p>
      <input class="setup-input" type="text" id="sheet-id-input" placeholder="Paste Google Sheet ID here..." />
      <br>
      <button class="setup-btn" onclick="saveSheetId()">SAVE & CONNECT</button>
      <p id="setup-status" style="margin-top:0.75rem; color: var(--neon-green); font-size:0.8rem;"></p>

      <br><br>
      <h3 style="color:var(--neon-yellow);text-shadow:0 0 10px var(--neon-yellow)">APPS SCRIPT TOKEN</h3>
      <p>To write roster changes back to Google Sheets, paste your Apps Script Web App URL here. See the Apps Script setup guide below.</p>
      <input class="setup-input" type="text" id="webapp-url-input" placeholder="Paste Apps Script Web App URL here..." />
      <button class="setup-btn" onclick="saveWebAppUrl()">SAVE URL</button>
      <p id="webapp-status" style="margin-top:0.75rem; color: var(--neon-green); font-size:0.8rem;"></p>
    </div>
  </div>

</main>

<!-- Confirm Modal -->
<div class="modal-overlay" id="confirm-modal">
  <div class="modal">
    <h3>‚ö† CONFIRM TRADE</h3>
    <div class="modal-detail" id="modal-detail-text"></div>
    <div class="modal-actions">
      <button class="modal-cancel" onclick="closeModal()">CANCEL</button>
      <button class="modal-confirm" onclick="executeTransaction()">CONFIRM</button>
    </div>
  </div>
</div>

<script>
// ============================================================
//  CONFIG & DATA
// ============================================================

const TEAM_META = {
  "Team Rick": { cls: "rick" },
  "Team Joe":  { cls: "joe"  },
  "Team Rory": { cls: "rory" }
};

// Base rosters - will be overridden by saved state
const BASE_ROSTERS = {
  "Team Rick": [
    { name:"Gannon Buhr",     division:"MPO" },
    { name:"Niklas Anttila",  division:"MPO" },
    { name:"Luke Taylor",     division:"MPO" },
    { name:"Lauri Lehtinen",  division:"MPO" },
    { name:"Simon Lizotte",   division:"MPO" },
    { name:"Holyn Handley",   division:"FPO" },
    { name:"Kat Mertsch",     division:"FPO" },
    { name:"Henna Blomroos",  division:"FPO" }
  ],
  "Team Joe": [
    { name:"Calvin Heimburg", division:"MPO" },
    { name:"Isaac Robinson",  division:"MPO" },
    { name:"Aaron Gossage",   division:"MPO" },
    { name:"Eagle McMahon",   division:"MPO" },
    { name:"Silas Schultz",   division:"MPO" },
    { name:"Eveliina Salonen",division:"FPO" },
    { name:"Paige Pierce",    division:"FPO" },
    { name:"Missy Gannon",    division:"FPO" }
  ],
  "Team Rory": [
    { name:"Anthony Barela",  division:"MPO" },
    { name:"Paul McBeth",     division:"MPO" },
    { name:"Ezra Aderhold",   division:"MPO" },
    { name:"Mauri Villmann",  division:"MPO" },
    { name:"Matthew Orum",    division:"MPO" },
    { name:"Silva Saarinen",  division:"FPO" },
    { name:"Cadence Burge",   division:"FPO" },
    { name:"Anniken Kristiansen Steen", division:"FPO" }
  ]
};

// Statmando Official MPO Rankings ‚Äî Top 50 (Feb 2026)
const MPO_RANKINGS = [
  {rank:1,  name:"Gannon Buhr"},      {rank:2,  name:"Paul McBeth"},
  {rank:3,  name:"Calvin Heimburg"},  {rank:4,  name:"Anthony Barela"},
  {rank:5,  name:"Isaac Robinson"},   {rank:6,  name:"Richard Wysocki"},
  {rank:7,  name:"Niklas Anttila"},   {rank:8,  name:"Kyle Klein"},
  {rank:9,  name:"Ezra Robinson"},    {rank:10, name:"Cole Redalen"},
  {rank:11, name:"Adam Hammes"},      {rank:12, name:"Aaron Gossage"},
  {rank:13, name:"Ezra Aderhold"},    {rank:14, name:"Simon Lizotte"},
  {rank:15, name:"Andrew Marwede"},   {rank:16, name:"Mauri Villmann"},
  {rank:17, name:"Evan Smith"},       {rank:18, name:"Luke Taylor"},
  {rank:19, name:"Sullivan Tipton"},  {rank:20, name:"Chris Dickerson"},
  {rank:21, name:"Corey Ellis"},      {rank:22, name:"Lauri Lehtinen"},
  {rank:23, name:"Austin Turner"},    {rank:24, name:"Gavin Babcock"},
  {rank:25, name:"Joseph Anderson"},  {rank:26, name:"Paul Krans"},
  {rank:27, name:"Matthew Orum"},     {rank:28, name:"Eagle McMahon"},
  {rank:29, name:"Benjamin Callaway"},{rank:30, name:"Silas Schultz"},
  {rank:31, name:"Bradley Williams"}, {rank:32, name:"Evan Scott"},
  {rank:33, name:"Casey White"},      {rank:34, name:"Andrew Presnell"},
  {rank:35, name:"Mason Ford"},       {rank:36, name:"James Proctor"},
  {rank:37, name:"Daniel Davidsson"}, {rank:38, name:"V√§in√∂ M√§kel√§"},
  {rank:39, name:"Parker Welck"},     {rank:40, name:"Zachary Nash"},
  {rank:41, name:"Jakub Semer√°d"},    {rank:42, name:"Jake Monn"},
  {rank:43, name:"Joel Freeman"},     {rank:44, name:"Paul Ulibarri"},
  {rank:45, name:"Noah Meintsma"},    {rank:46, name:"Nathan Queen"},
  {rank:47, name:"Jaden Rye"},        {rank:48, name:"Jesse Nieminen"},
  {rank:49, name:"Harry Chace"},      {rank:50, name:"Cale Leiviska"}
];

// Statmando Official FPO Rankings ‚Äî Top 30 (Feb 2026)
const FPO_RANKINGS = [
  {rank:1,  name:"Kristin L√§tt"},          {rank:2,  name:"Silva Saarinen"},
  {rank:3,  name:"Missy Gannon"},          {rank:4,  name:"Holyn Handley"},
  {rank:5,  name:"Eveliina Salonen"},      {rank:6,  name:"Henna Blomroos"},
  {rank:7,  name:"Paige Pierce"},          {rank:8,  name:"Kat Mertsch"},
  {rank:9,  name:"Corinne Grzeskowiak"},   {rank:10, name:"Catrina Allen"},
  {rank:11, name:"Ohn Scoggins"},          {rank:12, name:"Ella Hansen"},
  {rank:13, name:"Jennifer Allen"},        {rank:14, name:"Vanessa Van Dyken"},
  {rank:15, name:"Heather Young"},         {rank:16, name:"Macie Velediaz"},
  {rank:17, name:"Hailey King"},           {rank:18, name:"Juliana Korver"},
  {rank:19, name:"Sarah Hokom"},           {rank:20, name:"Kona Star Panis"},
  {rank:21, name:"Lisa Fajkus"},           {rank:22, name:"Paige Shue"},
  {rank:23, name:"Lykke Lorentzen"},       {rank:24, name:"Anniken Kristiansen Steen"},
  {rank:25, name:"Cadence Burge"},         {rank:26, name:"Jessie Grapenthien"},
  {rank:27, name:"Elaine King"},           {rank:28, name:"Rebecca Cox"},
  {rank:29, name:"Madison Walker"},        {rank:30, name:"Alexis Mandujano"}
];

// ============================================================
//  STATE
// ============================================================

let SHEET_ID   = localStorage.getItem('dg_sheet_id')   || '';
let WEBAPP_URL = localStorage.getItem('dg_webapp_url') || '';
let ROSTERS    = JSON.parse(JSON.stringify(BASE_ROSTERS));
let pendingAdd = null;
let currentDiv = 'MPO';

function loadState() {
  const saved = localStorage.getItem('dg_rosters');
  if (saved) { try { ROSTERS = JSON.parse(saved); } catch(e) {} }
}

function saveRostersLocal() {
  localStorage.setItem('dg_rosters', JSON.stringify(ROSTERS));
}

function getTxnLog()         { try { return JSON.parse(localStorage.getItem('dg_txn_log')||'[]'); } catch(e) { return []; } }
function saveTxnLog(log)     { localStorage.setItem('dg_txn_log', JSON.stringify(log)); }
function getTeamTxnCount(t)  { return getTxnLog().filter(x => x.team === t).length; }
function getTransactionCost(t) { return (getTeamTxnCount(t) + 1) * 10; }

// ============================================================
//  GOOGLE SHEETS ‚Äî READ
// ============================================================

function sheetUrl(name) {
  return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(name)}`;
}

async function fetchSheet(name) {
  const res  = await fetch(sheetUrl(name));
  const text = await res.text();
  const json = JSON.parse(text.substring(47).slice(0,-2));
  const cols = json.table.cols.map(c => c.label);
  return json.table.rows.filter(r=>r).map(row =>
    row.c.reduce((obj,cell,i) => { obj[cols[i]] = cell ? cell.v : null; return obj; }, {})
  );
}

// ============================================================
//  GOOGLE SHEETS ‚Äî WRITE (via Apps Script Web App)
// ============================================================

async function syncRostersToSheet() {
  if (!WEBAPP_URL) return;

  const msg = document.getElementById('sync-status-msg');
  msg.innerHTML = '<span class="sync-status sync-pending">‚è≥ SYNCING...</span>';

  try {
    const payload = {
      action: 'updateRosters',
      rosters: ROSTERS,
      transactions: getTxnLog()
    };

    await fetch(WEBAPP_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    msg.innerHTML = '<span class="sync-status sync-ok">‚úì SYNCED TO SHEET</span>';
    setTimeout(() => { msg.innerHTML = ''; }, 4000);

  } catch(e) {
    msg.innerHTML = '<span class="sync-status sync-error">‚úó SYNC FAILED ‚Äî saved locally</span>';
  }
}

function saveSheetId() {
  const val = document.getElementById('sheet-id-input').value.trim();
  if (!val) return;
  SHEET_ID = val;
  localStorage.setItem('dg_sheet_id', val);
  document.getElementById('setup-status').textContent = '‚úÖ Sheet connected! Loading data...';
  loadSheetData();
}

function saveWebAppUrl() {
  const val = document.getElementById('webapp-url-input').value.trim();
  if (!val) return;
  WEBAPP_URL = val;
  localStorage.setItem('dg_webapp_url', val);
  document.getElementById('webapp-status').textContent = '‚úÖ Web App URL saved!';
}

async function loadSheetData() {
  if (!SHEET_ID) { showNoSheet(); return; }
  try {
    const [standings, players, results] = await Promise.all([
      fetchSheet('Standings').catch(()=>null),
      fetchSheet('Player Stats').catch(()=>null),
      fetchSheet('Results').catch(()=>null)
    ]);
    renderStandings(standings);
    renderPlayers(players);
    renderResults(results);
  } catch(e) {
    showError('Could not load data. Check that your sheet is published publicly and the ID is correct.');
  }
}

function showNoSheet() {
  const msg = `<div class="empty-msg">No Google Sheet connected yet.<br>Go to <strong>Setup</strong> tab to connect your sheet.</div>`;
  ['standings-content','players-content','results-content'].forEach(id => {
    document.getElementById(id).innerHTML = msg;
  });
}

function showError(msg) {
  ['standings-content','players-content','results-content'].forEach(id => {
    document.getElementById(id).innerHTML = `<div class="empty-msg">${msg}</div>`;
  });
}

// ============================================================
//  NAVIGATION
// ============================================================

function showPage(page, btn) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.getElementById('page-'+page).classList.add('active');
  if (btn) btn.classList.add('active');
  if (page==='waiver') renderWaiver();
  if (page==='roster') renderRoster();
}

// ============================================================
//  RENDER STANDINGS
// ============================================================

function renderStandings(data) {
  const el = document.getElementById('standings-content');
  if (!data || !data.length) {
    el.innerHTML = `<div class="empty-msg">No standings yet ‚Äî check back after the first tournament! The Supreme Flight Open is this weekend.</div>`;
    return;
  }

  const log = getTxnLog();
  const deductions = {};
  log.forEach(t => { deductions[t.team] = (deductions[t.team]||0) + t.cost; });

  const rows = data.filter(r => r['Team'] && r['Total Points'] !== null);
  rows.sort((a,b) => {
    const ap = (a['Total Points']||0) - (deductions[a['Team']]||0);
    const bp = (b['Total Points']||0) - (deductions[b['Team']]||0);
    return bp - ap;
  });

  const medals = ['üèÜ','ü•à','ü•â'];
  el.innerHTML = rows.map((row,i) => {
    const team = row['Team']||'';
    const base = row['Total Points']||0;
    const ded  = deductions[team]||0;
    const pts  = base - ded;
    const tc   = TEAM_META[team]||{cls:'rick'};
    const txns = getTeamTxnCount(team);

    return `
      <div class="team-card ${tc.cls} ${i===0?'first':''}">
        <div class="scan"></div>
        <div class="team-rank">${medals[i]||i+1}</div>
        <div class="team-info">
          <div class="team-name">${team}</div>
          <div class="team-meta">${txns} TRADE${txns!==1?'S':''} ¬∑ ${ded>0?`-${ded} PTS DEDUCTED`:''}</div>
        </div>
        <div class="team-pts-wrap">
          <div class="team-points">${pts}</div>
          <div class="team-pts-label">TOTAL PTS</div>
        </div>
      </div>`;
  }).join('');
}

// ============================================================
//  RENDER PLAYERS
// ============================================================

function renderPlayers(data) {
  const el = document.getElementById('players-content');
  if (!data||!data.length) {
    el.innerHTML = `<div class="empty-msg">No player stats yet. Check back after the first tournament!</div>`;
    return;
  }

  const rows = data.filter(r=>r['Player']||r['Player Name']);
  rows.sort((a,b)=>(b['Total Points']||0)-(a['Total Points']||0));

  const tbody = rows.map((row,i) => {
    const name = row['Player']||row['Player Name']||'';
    const team = row['Team']||'';
    const div  = row['Division']||'';
    const pts  = row['Total Points']||0;
    const tc   = TEAM_META[team]||{cls:'rick'};
    let rp = `<span class="rank-pill">${i+1}</span>`;
    if(i===0) rp=`<span class="rank-pill r1">${i+1}</span>`;
    if(i===1) rp=`<span class="rank-pill r2">${i+1}</span>`;
    if(i===2) rp=`<span class="rank-pill r3">${i+1}</span>`;

    return `
      <tr>
        <td class="center">${rp}</td>
        <td><span class="team-dot dot-${tc.cls}"></span>${name}</td>
        <td>${team}</td>
        <td class="center"><span class="div-pill div-${div.toLowerCase()}">${div}</span></td>
        <td class="center" style="font-family:'Press Start 2P',monospace;font-size:0.75rem;color:#ffe600;text-shadow:0 0 8px #ffe600">${pts}</td>
      </tr>`;
  }).join('');

  el.innerHTML = `
    <div class="neon-panel">
      <table class="retro-table">
        <thead><tr>
          <th class="center">Rank</th><th>Player</th><th>Team</th>
          <th class="center">Div</th><th class="center">PTS</th>
        </tr></thead>
        <tbody>${tbody}</tbody>
      </table>
    </div>`;
}

// ============================================================
//  RENDER RESULTS
// ============================================================

function renderResults(data) {
  const el = document.getElementById('results-content');
  if (!data||!data.length) {
    el.innerHTML = `<div class="empty-msg">No results yet! The Supreme Flight Open tees off this weekend ‚Äî check back Monday.</div>`;
    return;
  }

  const byT = {};
  data.forEach(row => {
    const t = row['Tournament'];
    if (!t) return;
    if (!byT[t]) byT[t] = { type:row['Type']||'Regular', mult:row['Multiplier']||'1x', mpo:[], fpo:[] };
    const entry = { place:row['Place'], player:row['Player'], team:row['Team'], pts:row['Final Pts']||row['Base Pts']||0 };
    if ((row['Division']||'').toUpperCase()==='MPO') byT[t].mpo.push(entry);
    else byT[t].fpo.push(entry);
  });

  el.innerHTML = Object.entries(byT).map(([name,t]) => {
    const tc = t.type.toLowerCase().includes('major')?'major':t.type.toLowerCase().includes('elite')?'eliteplus':'regular';
    const makeRows = arr => arr.map(r => {
      const pc = r.place===1?'p1':r.place===2?'p2':r.place===3?'p3':'';
      const tm = TEAM_META[r.team];
      const dft = tm && r.team !== '‚Äî';
      return `
        <div class="result-row">
          <span class="result-place ${pc}">${r.place}</span>
          <span class="result-player ${dft?'drafted':''}">
            ${dft?`<span class="team-dot dot-${tm.cls}"></span>`:''}${r.player||''}
          </span>
          ${dft&&r.pts?`<span class="result-pts">+${r.pts}</span>`:''}
        </div>`;
    }).join('');

    return `
      <div class="result-card">
        <div class="result-header">
          <div class="result-name">${name}</div>
          <div class="result-meta">
            <span class="type-badge type-${tc}">${t.type}</span>
            <span class="mult-tag">${t.mult}</span>
          </div>
        </div>
        <div class="result-body">
          <div class="div-col"><div class="div-label">// MPO</div>${t.mpo.length?makeRows(t.mpo):'<span style="color:var(--muted);font-size:.8rem">No data</span>'}</div>
          <div class="div-col"><div class="div-label">// FPO</div>${t.fpo.length?makeRows(t.fpo):'<span style="color:var(--muted);font-size:.8rem">No data</span>'}</div>
        </div>
      </div>`;
  }).join('');
}

// ============================================================
//  RENDER ROSTER
// ============================================================

function renderRoster() {
  const el = document.getElementById('roster-content');
  el.innerHTML = Object.entries(ROSTERS).map(([team,players]) => {
    const tc  = TEAM_META[team]||{cls:'rick'};
    const mpo = players.filter(p=>p.division==='MPO');
    const fpo = players.filter(p=>p.division==='FPO');
    return `
      <div class="roster-card">
        <div class="roster-head ${tc.cls}">${team}</div>
        <div class="div-section-label">// MPO</div>
        ${mpo.map(p=>`<div class="roster-player"><span>${p.name}</span><span class="div-pill div-mpo">MPO</span></div>`).join('')}
        <div class="div-section-label">// FPO</div>
        ${fpo.map(p=>`<div class="roster-player"><span>${p.name}</span><span class="div-pill div-fpo">FPO</span></div>`).join('')}
      </div>`;
  }).join('');
}

// ============================================================
//  WAIVER WIRE
// ============================================================

function getAllDraftedNames() {
  const names = new Set();
  Object.values(ROSTERS).forEach(team => team.forEach(p => names.add(p.name.toLowerCase())));
  return names;
}

function showWaiverDiv(div, btn) {
  currentDiv = div;
  document.querySelectorAll('.waiver-tab').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderWaiverTable();
}

function renderWaiver() {
  renderWaiverTable();
  updateTxnPanel();
  renderTxnLog();
}

function renderWaiverTable() {
  const drafted  = getAllDraftedNames();
  const rankings = currentDiv === 'MPO' ? MPO_RANKINGS : FPO_RANKINGS;
  const tbody    = document.getElementById('waiver-tbody');

  tbody.innerHTML = rankings.map(p => {
    const isDrafted = drafted.has(p.name.toLowerCase());
    const status = isDrafted
      ? `<span style="font-family:'Press Start 2P',monospace;font-size:.45rem;color:var(--muted);background:var(--panel2);padding:3px 8px;border-radius:4px;border:1px solid var(--border2)">ON ROSTER</span>`
      : `<span style="font-family:'Press Start 2P',monospace;font-size:.45rem;color:var(--neon-green);background:var(--neon-green)10;padding:3px 8px;border-radius:4px;border:1px solid var(--neon-green)30;text-shadow:0 0 6px var(--neon-green)">FREE AGENT</span>`;

    const action = isDrafted
      ? `<span style="color:var(--muted);font-size:.75rem">‚Äî</span>`
      : `<button class="add-btn" onclick="selectAdd('${p.name.replace(/'/g,"\\'")}','${currentDiv}')">+ ADD</button>`;

    return `
      <tr>
        <td class="center"><span class="rank-pill">${p.rank}</span></td>
        <td>${p.name}</td>
        <td class="center">${status}</td>
        <td class="center">${action}</td>
      </tr>`;
  }).join('');
}

function selectAdd(playerName, division) {
  pendingAdd = { name: playerName, division };
  const el = document.getElementById('txn-add-display');
  el.textContent = playerName;
  el.className = 'selected-add filled';
  updateTxnPanel();
}

function updateTxnPanel() {
  const team     = document.getElementById('txn-team').value;
  const dropSel  = document.getElementById('txn-drop');
  const costLbl  = document.getElementById('txn-cost-label');
  const costPts  = document.getElementById('txn-cost-pts');
  const btn      = document.getElementById('txn-confirm-btn');

  // Populate drop list (same division only)
  dropSel.innerHTML = '<option value="">‚Äî Select player to drop ‚Äî</option>';
  if (team && pendingAdd) {
    (ROSTERS[team]||[])
      .filter(p => p.division === pendingAdd.division)
      .forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.name;
        opt.textContent = p.name;
        dropSel.appendChild(opt);
      });
  }

  if (team) {
    const cost  = getTransactionCost(team);
    const count = getTeamTxnCount(team);
    costLbl.textContent = `Trade #${count+1} for ${team}`;
    costPts.textContent = `-${cost} pts`;
  } else {
    costLbl.textContent = 'Select team first';
    costPts.textContent = '‚Äî';
  }

  btn.disabled = !(team && pendingAdd && dropSel.value);
}

function openConfirmModal() {
  const team = document.getElementById('txn-team').value;
  const drop = document.getElementById('txn-drop').value;
  const cost = getTransactionCost(team);
  if (!team || !pendingAdd || !drop) return;

  document.getElementById('modal-detail-text').innerHTML = `
    <strong>Team:</strong> ${team}<br>
    <span style="color:var(--neon-green)">+ Adding: ${pendingAdd.name} (${pendingAdd.division})</span><br>
    <span style="color:var(--neon-pink)">‚àí Dropping: ${drop}</span><br><br>
    <span class="warn">‚ö† This will deduct ${cost} points from ${team}.</span><br>
    <span style="color:var(--muted);font-size:.78rem">This action is permanent and cannot be undone.</span>`;

  document.getElementById('confirm-modal').classList.add('open');
}

function closeModal() {
  document.getElementById('confirm-modal').classList.remove('open');
}

function executeTransaction() {
  const team = document.getElementById('txn-team').value;
  const drop = document.getElementById('txn-drop').value;
  const cost = getTransactionCost(team);
  if (!team || !pendingAdd || !drop) return;

  // Update roster
  ROSTERS[team] = ROSTERS[team].filter(p => p.name !== drop);
  ROSTERS[team].push({ name: pendingAdd.name, division: pendingAdd.division });
  saveRostersLocal();

  // Log it
  const log = getTxnLog();
  const entry = {
    team,
    added:   pendingAdd.name,
    dropped: drop,
    division: pendingAdd.division,
    cost,
    date: new Date().toLocaleDateString()
  };
  log.push(entry);
  saveTxnLog(log);

  closeModal();

  // Sync to Google Sheet
  syncRostersToSheet();

  // Reset
  const addedName = pendingAdd.name;
  pendingAdd = null;
  document.getElementById('txn-add-display').textContent = 'Click ADD next to a player';
  document.getElementById('txn-add-display').className = 'selected-add';
  document.getElementById('txn-team').value = '';
  document.getElementById('txn-drop').innerHTML = '<option value="">‚Äî Select player to drop ‚Äî</option>';
  document.getElementById('txn-confirm-btn').disabled = true;

  renderWaiver();
  renderRoster();
  if (SHEET_ID) loadSheetData();
}

function renderTxnLog() {
  const log = getTxnLog();
  const el  = document.getElementById('txn-log-list');
  if (!log.length) {
    el.innerHTML = '<div class="txn-entry">No transactions yet.</div>';
    return;
  }
  el.innerHTML = [...log].reverse().map(t => `
    <div class="txn-entry">
      <strong>${t.team}</strong> ¬∑ ${t.date}<br>
      <span class="in">+ ${t.added}</span> / <span class="out">- ${t.dropped}</span>
      <span class="cost-tag"> -${t.cost}pts</span>
    </div>`).join('');
}

// ============================================================
//  INIT
// ============================================================

loadState();
renderRoster();

if (SHEET_ID) {
  document.getElementById('sheet-id-input').value = SHEET_ID;
  loadSheetData();
} else {
  showNoSheet();
}

if (WEBAPP_URL) {
  document.getElementById('webapp-url-input').value = WEBAPP_URL;
}
</script>
</body>
</html>
