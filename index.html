<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rick is #1 Fantasy League</title>
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;900&family=Barlow:wght@400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0c10;
    --surface: #12151c;
    --surface2: #1a1e28;
    --border: #ffffff12;
    --accent: #e8ff00;
    --accent2: #00d4ff;
    --rick: #3b82f6;
    --joe: #f43f5e;
    --rory: #22c55e;
    --text: #f0f4ff;
    --muted: #6b7280;
    --gold: #fbbf24;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Barlow', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse at 20% 20%, #3b82f610 0%, transparent 50%),
      radial-gradient(ellipse at 80% 80%, #e8ff0008 0%, transparent 50%),
      url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.02'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  /* ---- HEADER ---- */
  header {
    position: relative;
    z-index: 10;
    padding: 0 2rem;
    border-bottom: 1px solid var(--border);
    background: #0a0c10ee;
    backdrop-filter: blur(20px);
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 72px;
    position: sticky;
    top: 0;
  }

  .logo {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 900;
    font-size: 1.6rem;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    line-height: 1;
  }

  .logo span {
    color: var(--accent);
  }

  .logo-disc {
    display: inline-block;
    width: 32px;
    height: 32px;
    background: var(--accent);
    border-radius: 50%;
    margin-right: 10px;
    vertical-align: middle;
    position: relative;
    top: -2px;
    box-shadow: 0 0 20px var(--accent)80;
  }

  .logo-disc::after {
    content: '';
    position: absolute;
    inset: 6px;
    background: var(--bg);
    border-radius: 50%;
  }

  nav {
    display: flex;
    gap: 0.25rem;
  }

  nav button {
    background: transparent;
    border: none;
    color: var(--muted);
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    font-size: 0.95rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.5rem 1rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s;
  }

  nav button:hover { color: var(--text); background: var(--surface2); }
  nav button.active { color: var(--accent); background: var(--accent)15; }

  .last-updated {
    font-size: 0.75rem;
    color: var(--muted);
    text-align: right;
  }

  /* ---- MAIN ---- */
  main {
    position: relative;
    z-index: 1;
    max-width: 1100px;
    margin: 0 auto;
    padding: 2.5rem 2rem;
  }

  .page { display: none; }
  .page.active { display: block; }

  /* ---- SECTION TITLE ---- */
  .section-title {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 900;
    font-size: 2.8rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    line-height: 1;
    margin-bottom: 2rem;
  }

  .section-title span { color: var(--accent); }

  /* ---- STANDINGS ---- */
  .standings-grid {
    display: grid;
    gap: 1rem;
    margin-bottom: 2rem;
  }

  .team-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.75rem 2rem;
    display: flex;
    align-items: center;
    gap: 2rem;
    position: relative;
    overflow: hidden;
    transition: transform 0.2s, border-color 0.2s;
    animation: slideIn 0.4s ease both;
  }

  .team-card:nth-child(1) { animation-delay: 0.05s; }
  .team-card:nth-child(2) { animation-delay: 0.1s; }
  .team-card:nth-child(3) { animation-delay: 0.15s; }

  @keyframes slideIn {
    from { opacity: 0; transform: translateY(16px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .team-card:hover { transform: translateY(-2px); }

  .team-card::before {
    content: '';
    position: absolute;
    left: 0; top: 0; bottom: 0;
    width: 4px;
    border-radius: 4px 0 0 4px;
  }

  .team-card.rick::before { background: var(--rick); }
  .team-card.joe::before  { background: var(--joe); }
  .team-card.rory::before { background: var(--rory); }

  .team-card.first {
    border-color: var(--gold)50;
    background: linear-gradient(135deg, #1a1a0a 0%, var(--surface) 100%);
  }

  .team-card.first::after {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at 0% 50%, var(--gold)08 0%, transparent 60%);
    pointer-events: none;
  }

  .team-rank {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 900;
    font-size: 3.5rem;
    color: var(--muted);
    line-height: 1;
    min-width: 60px;
    text-align: center;
  }

  .team-card.first .team-rank { color: var(--gold); }

  .team-info { flex: 1; }

  .team-name {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1.6rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.25rem;
  }

  .team-card.rick .team-name { color: #93c5fd; }
  .team-card.joe  .team-name { color: #fda4af; }
  .team-card.rory .team-name { color: #86efac; }

  .team-subtitle {
    font-size: 0.8rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .team-points {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 900;
    font-size: 3.2rem;
    line-height: 1;
    text-align: right;
  }

  .team-points-label {
    font-size: 0.7rem;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.12em;
    text-align: right;
  }

  .crown { font-size: 1.4rem; margin-right: 0.5rem; }

  /* ---- PLAYER STATS ---- */
  .stats-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--surface);
    border-radius: 16px;
    overflow: hidden;
    border: 1px solid var(--border);
  }

  .stats-table thead tr {
    background: var(--surface2);
  }

  .stats-table th {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--muted);
    padding: 1rem 1.25rem;
    text-align: left;
  }

  .stats-table th:last-child,
  .stats-table th:first-child { text-align: center; }

  .stats-table td {
    padding: 0.9rem 1.25rem;
    border-top: 1px solid var(--border);
    font-size: 0.95rem;
  }

  .stats-table td:first-child { text-align: center; }
  .stats-table td:last-child  { text-align: center; font-family: 'Barlow Condensed', sans-serif; font-weight: 700; font-size: 1.1rem; }

  .stats-table tbody tr {
    transition: background 0.15s;
    animation: fadeIn 0.3s ease both;
  }

  .stats-table tbody tr:hover { background: var(--surface2); }

  @keyframes fadeIn {
    from { opacity: 0; }
    to   { opacity: 1; }
  }

  .rank-badge {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: var(--surface2);
  }

  .rank-badge.gold   { background: var(--gold); color: #000; }
  .rank-badge.silver { background: #9ca3af; color: #000; }
  .rank-badge.bronze { background: #b45309; color: #fff; }

  .team-dot {
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-right: 8px;
    vertical-align: middle;
  }

  .dot-rick  { background: var(--rick); }
  .dot-joe   { background: var(--joe); }
  .dot-rory  { background: var(--rory); }

  .div-badge {
    font-size: 0.7rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    padding: 2px 8px;
    border-radius: 4px;
    text-transform: uppercase;
  }

  .div-mpo { background: #3b82f620; color: #93c5fd; }
  .div-fpo { background: #f43f5e20; color: #fda4af; }

  /* ---- RESULTS ---- */
  .results-grid {
    display: grid;
    gap: 1.25rem;
  }

  .result-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    animation: slideIn 0.4s ease both;
  }

  .result-header {
    padding: 1.25rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--border);
    background: var(--surface2);
  }

  .result-name {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1.2rem;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }

  .result-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .type-badge {
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    padding: 3px 10px;
    border-radius: 20px;
    text-transform: uppercase;
  }

  .type-major     { background: var(--gold)25; color: var(--gold); border: 1px solid var(--gold)40; }
  .type-eliteplus { background: var(--accent2)20; color: var(--accent2); border: 1px solid var(--accent2)40; }
  .type-regular   { background: var(--surface); color: var(--muted); border: 1px solid var(--border); }

  .multiplier-tag {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.85rem;
    color: var(--muted);
  }

  .result-body {
    display: grid;
    grid-template-columns: 1fr 1fr;
  }

  .div-section {
    padding: 1.25rem 1.5rem;
  }

  .div-section:first-child {
    border-right: 1px solid var(--border);
  }

  .div-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 0.8rem;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 0.75rem;
  }

  .result-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.4rem 0;
    font-size: 0.9rem;
  }

  .result-place {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    min-width: 28px;
    color: var(--muted);
  }

  .result-place.p1 { color: var(--gold); }
  .result-place.p2 { color: #9ca3af; }
  .result-place.p3 { color: #b45309; }

  .result-player { flex: 1; }
  .result-player.drafted { font-weight: 600; }

  .result-pts {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    color: var(--accent);
  }

  /* ---- ROSTER ---- */
  .roster-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .roster-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 16px;
    overflow: hidden;
    animation: slideIn 0.4s ease both;
  }

  .roster-card:nth-child(1) { animation-delay: 0.05s; }
  .roster-card:nth-child(2) { animation-delay: 0.10s; }
  .roster-card:nth-child(3) { animation-delay: 0.15s; }

  .roster-header {
    padding: 1.25rem 1.5rem;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 900;
    font-size: 1.4rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    border-bottom: 1px solid var(--border);
  }

  .roster-header.rick { background: linear-gradient(135deg, #1e3a5f, var(--surface2)); color: #93c5fd; }
  .roster-header.joe  { background: linear-gradient(135deg, #5f1e2a, var(--surface2)); color: #fda4af; }
  .roster-header.rory { background: linear-gradient(135deg, #1e4a2a, var(--surface2)); color: #86efac; }

  .roster-player {
    padding: 0.75rem 1.5rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--border);
    font-size: 0.9rem;
    transition: background 0.15s;
  }

  .roster-player:last-child { border-bottom: none; }
  .roster-player:hover { background: var(--surface2); }

  .div-section-label {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 0.7rem;
    font-weight: 700;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--muted);
    padding: 0.5rem 1.5rem 0.25rem;
    background: var(--surface2);
  }

  /* ---- LOADING / EMPTY ---- */
  .loading {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--muted);
  }

  .loading-disc {
    width: 48px;
    height: 48px;
    border: 3px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 1rem;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  .error-msg {
    background: #f43f5e15;
    border: 1px solid #f43f5e40;
    border-radius: 12px;
    padding: 1.5rem;
    color: #fda4af;
    text-align: center;
    margin-bottom: 1rem;
  }

  .setup-box {
    background: var(--surface);
    border: 1px solid var(--accent)30;
    border-radius: 16px;
    padding: 2rem;
    margin-bottom: 2rem;
  }

  .setup-box h3 {
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1.1rem;
    color: var(--accent);
    text-transform: uppercase;
    letter-spacing: 0.08em;
    margin-bottom: 1rem;
  }

  .setup-box input {
    width: 100%;
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: 'Barlow', sans-serif;
    font-size: 0.9rem;
    padding: 0.75rem 1rem;
    margin-bottom: 0.75rem;
    outline: none;
    transition: border-color 0.2s;
  }

  .setup-box input:focus { border-color: var(--accent)60; }

  .setup-box button {
    background: var(--accent);
    color: #000;
    border: none;
    border-radius: 8px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 700;
    font-size: 1rem;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 0.75rem 2rem;
    cursor: pointer;
    transition: opacity 0.2s;
  }

  .setup-box button:hover { opacity: 0.85; }

  .setup-box p {
    font-size: 0.85rem;
    color: var(--muted);
    margin-bottom: 0.75rem;
    line-height: 1.6;
  }

  .setup-box code {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 0.1em 0.4em;
    font-size: 0.82rem;
    color: var(--accent2);
  }

  /* ---- RESPONSIVE ---- */
  @media (max-width: 768px) {
    .roster-grid { grid-template-columns: 1fr; }
    .result-body { grid-template-columns: 1fr; }
    .div-section:first-child { border-right: none; border-bottom: 1px solid var(--border); }
    .section-title { font-size: 2rem; }
    nav button { font-size: 0.8rem; padding: 0.4rem 0.6rem; }
    .logo { font-size: 1.2rem; }
  }
</style>
</head>
<body>

<header>
  <div class="logo">
    <span class="logo-disc"></span>
    Rick is <span>#1</span> Fantasy
  </div>
  <nav>
    <button class="active" onclick="showPage('standings', this)">Standings</button>
    <button onclick="showPage('players', this)">Players</button>
    <button onclick="showPage('results', this)">Results</button>
    <button onclick="showPage('roster', this)">Roster</button>
    <button onclick="showPage('setup', this)">âš™ Setup</button>
  </nav>
</header>

<main>

  <!-- ======== STANDINGS ======== -->
  <div id="page-standings" class="page active">
    <div class="section-title">League <span>Standings</span></div>
    <div id="standings-content" class="standings-grid">
      <div class="loading"><div class="loading-disc"></div>Loading standings...</div>
    </div>
  </div>

  <!-- ======== PLAYERS ======== -->
  <div id="page-players" class="page">
    <div class="section-title">Player <span>Stats</span></div>
    <div id="players-content">
      <div class="loading"><div class="loading-disc"></div>Loading player stats...</div>
    </div>
  </div>

  <!-- ======== RESULTS ======== -->
  <div id="page-results" class="page">
    <div class="section-title">Tournament <span>Results</span></div>
    <div id="results-content" class="results-grid">
      <div class="loading"><div class="loading-disc"></div>Loading results...</div>
    </div>
  </div>

  <!-- ======== ROSTER ======== -->
  <div id="page-roster" class="page">
    <div class="section-title">Team <span>Rosters</span></div>
    <div id="roster-content" class="roster-grid">
      <div class="loading"><div class="loading-disc"></div>Loading rosters...</div>
    </div>
  </div>

  <!-- ======== SETUP ======== -->
  <div id="page-setup" class="page">
    <div class="section-title">âš™ <span>Setup</span></div>
    <div class="setup-box">
      <h3>Connect Your Google Sheet</h3>
      <p>This website reads data directly from your Google Sheet. You need to publish your sheet publicly and paste the Sheet ID below. Here's how:</p>
      <p>1. Open your Google Sheet â†’ click <code>File</code> â†’ <code>Share</code> â†’ <code>Publish to web</code> â†’ click <code>Publish</code></p>
      <p>2. Your Sheet ID is the long string in the URL between <code>/d/</code> and <code>/edit</code>. Example:<br>
      <code>docs.google.com/spreadsheets/d/<strong>1BxiM...</strong>/edit</code></p>
      <p>3. Paste your Sheet ID below and click Save.</p>
      <input type="text" id="sheet-id-input" placeholder="Paste your Google Sheet ID here..." />
      <br>
      <button onclick="saveSheetId()">Save & Connect Sheet</button>
      <p id="setup-status" style="margin-top: 0.75rem; color: var(--accent);"></p>
    </div>
  </div>

</main>

<script>
// ============================================================
//  CONFIG
// ============================================================

const TEAMS = {
  "Team Rick": { class: "rick", color: "#3b82f6" },
  "Team Joe":  { class: "joe",  color: "#f43f5e" },
  "Team Rory": { class: "rory", color: "#22c55e" }
};

const ROSTER = [
  // Team Rick
  { name: "Gannon Buhr",     team: "Team Rick", division: "MPO" },
  { name: "Niklas Anttila",  team: "Team Rick", division: "MPO" },
  { name: "Luke Taylor",     team: "Team Rick", division: "MPO" },
  { name: "Lauri Lehtinen",  team: "Team Rick", division: "MPO" },
  { name: "Simon Lizotte",   team: "Team Rick", division: "MPO" },
  { name: "Holyn Handley",   team: "Team Rick", division: "FPO" },
  { name: "Kat Mertsch",     team: "Team Rick", division: "FPO" },
  { name: "Henna Blomroos",  team: "Team Rick", division: "FPO" },
  // Team Joe
  { name: "Calvin Heimburg", team: "Team Joe", division: "MPO" },
  { name: "Isaac Robinson",  team: "Team Joe", division: "MPO" },
  { name: "Aaron Gossage",   team: "Team Joe", division: "MPO" },
  { name: "Eagle McMahon",   team: "Team Joe", division: "MPO" },
  { name: "Silas Schultz",   team: "Team Joe", division: "MPO" },
  { name: "Eveliina Salonen",team: "Team Joe", division: "FPO" },
  { name: "Paige Pierce",    team: "Team Joe", division: "FPO" },
  { name: "Missy Gannon",    team: "Team Joe", division: "FPO" },
  // Team Rory
  { name: "Anthony Barela",  team: "Team Rory", division: "MPO" },
  { name: "Paul McBeth",     team: "Team Rory", division: "MPO" },
  { name: "Ezra Aderhold",   team: "Team Rory", division: "MPO" },
  { name: "Mauri Villmann",  team: "Team Rory", division: "MPO" },
  { name: "Matthew Orum",    team: "Team Rory", division: "MPO" },
  { name: "Silva Saarinen",  team: "Team Rory", division: "FPO" },
  { name: "Cadence Burge",   team: "Team Rory", division: "FPO" },
  { name: "Anniken Kristiansen Steen", team: "Team Rory", division: "FPO" }
];

const POINTS_TABLE = {1:25,2:18,3:15,4:12,5:10,6:8,7:6,8:4,9:2,10:1};
const MULTIPLIERS  = { regular: 1.0, elitePlus: 1.25, major: 1.5 };

// ============================================================
//  NAVIGATION
// ============================================================

function showPage(page, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  btn.classList.add('active');
}

// ============================================================
//  SHEET ID STORAGE
// ============================================================

let SHEET_ID = localStorage.getItem('discgolf_sheet_id') || '';

function saveSheetId() {
  const val = document.getElementById('sheet-id-input').value.trim();
  if (!val) return;
  SHEET_ID = val;
  localStorage.setItem('discgolf_sheet_id', val);
  document.getElementById('setup-status').textContent = 'âœ… Sheet connected! Loading data...';
  loadAllData();
}

// ============================================================
//  GOOGLE SHEETS API
// ============================================================

function sheetUrl(sheetName) {
  return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${encodeURIComponent(sheetName)}`;
}

async function fetchSheet(sheetName) {
  const res = await fetch(sheetUrl(sheetName));
  const text = await res.text();
  const json = JSON.parse(text.substring(47).slice(0, -2));
  const cols = json.table.cols.map(c => c.label);
  const rows = json.table.rows.map(row =>
    row ? row.c.reduce((obj, cell, i) => {
      obj[cols[i]] = cell ? cell.v : null;
      return obj;
    }, {}) : null
  ).filter(Boolean);
  return rows;
}

// ============================================================
//  LOAD ALL DATA
// ============================================================

async function loadAllData() {
  if (!SHEET_ID) {
    showNoSheet();
    return;
  }

  try {
    const [standingsData, playerData, resultsData] = await Promise.all([
      fetchSheet('Standings').catch(() => null),
      fetchSheet('Player Stats').catch(() => null),
      fetchSheet('Results').catch(() => null)
    ]);

    renderStandings(standingsData);
    renderPlayers(playerData);
    renderResults(resultsData);
    renderRoster();

  } catch (e) {
    console.error(e);
    showError('Could not load data from Google Sheet. Make sure your sheet is published publicly (File â†’ Share â†’ Publish to web) and the Sheet ID is correct. Go to the âš™ Setup tab to re-enter it.');
  }
}

function showNoSheet() {
  const msg = `
    <div class="error-msg">
      No Google Sheet connected yet.<br>
      Go to the <strong>âš™ Setup</strong> tab to connect your sheet.
    </div>`;
  document.getElementById('standings-content').innerHTML = msg;
  document.getElementById('players-content').innerHTML = msg;
  document.getElementById('results-content').innerHTML = msg;
  renderRoster();
}

function showError(msg) {
  const html = `<div class="error-msg">${msg}</div>`;
  document.getElementById('standings-content').innerHTML = html;
  document.getElementById('players-content').innerHTML = html;
  document.getElementById('results-content').innerHTML = html;
}

// ============================================================
//  RENDER STANDINGS
// ============================================================

function renderStandings(data) {
  const el = document.getElementById('standings-content');

  if (!data || data.length === 0) {
    el.innerHTML = `<div class="error-msg">No standings data yet. Results will appear after the first tournament.</div>`;
    return;
  }

  // Find columns
  const rows = data.filter(r => r['Team'] && r['Total Points'] !== null);
  if (rows.length === 0) {
    el.innerHTML = `<div class="error-msg">No standings data yet.</div>`;
    return;
  }

  // Sort by points
  rows.sort((a, b) => (b['Total Points'] || 0) - (a['Total Points'] || 0));

  const medals = ['ðŸ†', 'ðŸ¥ˆ', 'ðŸ¥‰'];

  el.innerHTML = rows.map((row, i) => {
    const team = row['Team'] || '';
    const pts  = row['Total Points'] || 0;
    const tc   = TEAMS[team] || { class: 'rick' };
    const isFirst = i === 0;

    return `
      <div class="team-card ${tc.class} ${isFirst ? 'first' : ''}">
        <div class="team-rank">${medals[i] || (i + 1)}</div>
        <div class="team-info">
          <div class="team-name">${team}</div>
          <div class="team-subtitle">2026 Season</div>
        </div>
        <div>
          <div class="team-points">${pts}</div>
          <div class="team-points-label">Points</div>
        </div>
      </div>`;
  }).join('');
}

// ============================================================
//  RENDER PLAYER STATS
// ============================================================

function renderPlayers(data) {
  const el = document.getElementById('players-content');

  if (!data || data.length === 0) {
    el.innerHTML = `<div class="error-msg">No player stats yet. Results will appear after the first tournament.</div>`;
    return;
  }

  const rows = data.filter(r => r['Player'] || r['Player Name']);
  if (rows.length === 0) {
    el.innerHTML = `<div class="error-msg">No player data found.</div>`;
    return;
  }

  rows.sort((a, b) => (b['Total Points'] || 0) - (a['Total Points'] || 0));

  const tableRows = rows.map((row, i) => {
    const name  = row['Player'] || row['Player Name'] || '';
    const team  = row['Team'] || '';
    const div   = row['Division'] || '';
    const pts   = row['Total Points'] || 0;
    const tc    = TEAMS[team] || { class: 'rick' };

    let rankBadge = `<span class="rank-badge">${i + 1}</span>`;
    if (i === 0) rankBadge = `<span class="rank-badge gold">${i + 1}</span>`;
    if (i === 1) rankBadge = `<span class="rank-badge silver">${i + 1}</span>`;
    if (i === 2) rankBadge = `<span class="rank-badge bronze">${i + 1}</span>`;

    return `
      <tr style="animation-delay: ${i * 0.03}s">
        <td>${rankBadge}</td>
        <td>
          <span class="team-dot dot-${tc.class}"></span>
          ${name}
        </td>
        <td>${team}</td>
        <td><span class="div-badge div-${div.toLowerCase()}">${div}</span></td>
        <td>${pts}</td>
      </tr>`;
  }).join('');

  el.innerHTML = `
    <table class="stats-table">
      <thead>
        <tr>
          <th>Rank</th>
          <th>Player</th>
          <th>Team</th>
          <th>Div</th>
          <th>Points</th>
        </tr>
      </thead>
      <tbody>${tableRows}</tbody>
    </table>`;
}

// ============================================================
//  RENDER RESULTS
// ============================================================

function renderResults(data) {
  const el = document.getElementById('results-content');

  if (!data || data.length === 0) {
    el.innerHTML = `<div class="error-msg">No results yet. Check back after the first tournament!</div>`;
    return;
  }

  // Group by tournament
  const byTournament = {};
  data.forEach(row => {
    const t = row['Tournament'];
    if (!t) return;
    if (!byTournament[t]) byTournament[t] = { type: row['Type'] || 'Regular', multiplier: row['Multiplier'] || '1x', mpo: [], fpo: [] };
    const div = (row['Division'] || '').toUpperCase();
    const entry = {
      place: row['Place'],
      player: row['Player'],
      team: row['Team'],
      pts: row['Final Pts'] || row['Base Pts'] || 0
    };
    if (div === 'MPO') byTournament[t].mpo.push(entry);
    else if (div === 'FPO') byTournament[t].fpo.push(entry);
  });

  el.innerHTML = Object.entries(byTournament).map(([name, t], i) => {
    const typeClass = t.type.toLowerCase().includes('major') ? 'major' :
                      t.type.toLowerCase().includes('elite') ? 'eliteplus' : 'regular';
    const typeLabel = t.type;

    const makeRows = (arr) => arr.map(r => {
      const pc = r.place === 1 ? 'p1' : r.place === 2 ? 'p2' : r.place === 3 ? 'p3' : '';
      const tc = TEAMS[r.team] || null;
      const drafted = !!r.team && r.team !== 'â€”';
      return `
        <div class="result-row">
          <span class="result-place ${pc}">${r.place}</span>
          <span class="result-player ${drafted ? 'drafted' : ''}">
            ${drafted ? `<span class="team-dot dot-${tc ? tc.class : ''}"></span>` : ''}
            ${r.player || ''}
          </span>
          ${drafted && r.pts ? `<span class="result-pts">+${r.pts}</span>` : ''}
        </div>`;
    }).join('');

    return `
      <div class="result-card" style="animation-delay: ${i * 0.05}s">
        <div class="result-header">
          <div class="result-name">${name}</div>
          <div class="result-meta">
            <span class="type-badge type-${typeClass}">${typeLabel}</span>
            <span class="multiplier-tag">${t.multiplier}</span>
          </div>
        </div>
        <div class="result-body">
          <div class="div-section">
            <div class="div-label">MPO</div>
            ${t.mpo.length ? makeRows(t.mpo) : '<div style="color: var(--muted); font-size: 0.85rem;">No MPO results</div>'}
          </div>
          <div class="div-section">
            <div class="div-label">FPO</div>
            ${t.fpo.length ? makeRows(t.fpo) : '<div style="color: var(--muted); font-size: 0.85rem;">No FPO results</div>'}
          </div>
        </div>
      </div>`;
  }).join('');
}

// ============================================================
//  RENDER ROSTER (static - always available)
// ============================================================

function renderRoster() {
  const el = document.getElementById('roster-content');

  const byTeam = {};
  ROSTER.forEach(p => {
    if (!byTeam[p.team]) byTeam[p.team] = { MPO: [], FPO: [] };
    byTeam[p.team][p.division].push(p.name);
  });

  el.innerHTML = Object.entries(byTeam).map(([team, players]) => {
    const tc = TEAMS[team] || { class: 'rick' };
    return `
      <div class="roster-card">
        <div class="roster-header ${tc.class}">${team}</div>
        <div class="div-section-label">MPO Players</div>
        ${players.MPO.map(name => `
          <div class="roster-player">
            <span>${name}</span>
            <span class="div-badge div-mpo">MPO</span>
          </div>`).join('')}
        <div class="div-section-label">FPO Players</div>
        ${players.FPO.map(name => `
          <div class="roster-player">
            <span>${name}</span>
            <span class="div-badge div-fpo">FPO</span>
          </div>`).join('')}
      </div>`;
  }).join('');
}

// ============================================================
//  INIT
// ============================================================

if (SHEET_ID) {
  document.getElementById('sheet-id-input').value = SHEET_ID;
  loadAllData();
} else {
  showNoSheet();
  renderRoster();
}
</script>
</body>
</html>
